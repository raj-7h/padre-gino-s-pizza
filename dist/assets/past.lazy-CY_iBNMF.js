var fe=t=>{throw TypeError(t)};var ee=(t,e,s)=>e.has(t)||fe("Cannot "+s);var r=(t,e,s)=>(ee(t,e,"read from private field"),s?s.call(t):e.get(t)),R=(t,e,s)=>e.has(t)?fe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),f=(t,e,s,i)=>(ee(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s),m=(t,e,s)=>(ee(t,e,"access private method"),s);import{S as we,p as pe,r as U,s as se,a as z,n as Ie,i as re,b as me,t as Te,f as Pe,c as Qe,d as be,e as Ce,g as y,u as Fe,h as De,j as a,k as ke,l as je}from"./index-BAi2JHJ6.js";import{s as Ue,n as Be}from"./utils-km2FGkQ4.js";var O,c,Y,S,H,V,_,k,Z,$,G,K,q,M,J,h,X,ie,ne,ae,oe,le,ce,he,Ee,Re,Le=(Re=class extends we{constructor(e,s){super();R(this,h);R(this,O);R(this,c);R(this,Y);R(this,S);R(this,H);R(this,V);R(this,_);R(this,k);R(this,Z);R(this,$);R(this,G);R(this,K);R(this,q);R(this,M);R(this,J,new Set);this.options=s,f(this,O,e),f(this,k,null),f(this,_,pe()),this.options.experimental_prefetchInRender||r(this,_).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,c).addObserver(this),ye(r(this,c),this.options)?m(this,h,X).call(this):this.updateResult(),m(this,h,oe).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ue(r(this,c),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ue(r(this,c),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,m(this,h,le).call(this),m(this,h,ce).call(this),r(this,c).removeObserver(this)}setOptions(e,s){const i=this.options,l=r(this,c);if(this.options=r(this,O).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof U(this.options.enabled,r(this,c))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");m(this,h,he).call(this),r(this,c).setOptions(this.options),i._defaulted&&!se(this.options,i)&&r(this,O).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,c),observer:this});const o=this.hasListeners();o&&ge(r(this,c),l,this.options,i)&&m(this,h,X).call(this),this.updateResult(s),o&&(r(this,c)!==l||U(this.options.enabled,r(this,c))!==U(i.enabled,r(this,c))||z(this.options.staleTime,r(this,c))!==z(i.staleTime,r(this,c)))&&m(this,h,ie).call(this);const n=m(this,h,ne).call(this);o&&(r(this,c)!==l||U(this.options.enabled,r(this,c))!==U(i.enabled,r(this,c))||n!==r(this,M))&&m(this,h,ae).call(this,n)}getOptimisticResult(e){const s=r(this,O).getQueryCache().build(r(this,O),e),i=this.createResult(s,e);return Me(this,i)&&(f(this,S,i),f(this,V,this.options),f(this,H,r(this,c).state)),i}getCurrentResult(){return r(this,S)}trackResult(e,s){const i={};return Object.keys(e).forEach(l=>{Object.defineProperty(i,l,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(l),s==null||s(l),e[l])})}),i}trackProp(e){r(this,J).add(e)}getCurrentQuery(){return r(this,c)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=r(this,O).defaultQueryOptions(e),i=r(this,O).getQueryCache().build(r(this,O),s);return i.fetch().then(()=>this.createResult(i,s))}fetch(e){return m(this,h,X).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,S)))}createResult(e,s){var L;const i=r(this,c),l=this.options,o=r(this,S),n=r(this,H),v=r(this,V),b=e!==i?e.state:r(this,Y),{state:j}=e;let u={...j},w=!1,g;if(s._optimisticResults){const p=this.hasListeners(),I=!p&&ye(e,s),T=p&&ge(e,i,s,l);(I||T)&&(u={...u,...Qe(j.data,e.options)}),s._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:P,errorUpdatedAt:E,status:C}=u;if(s.select&&u.data!==void 0)if(o&&u.data===(n==null?void 0:n.data)&&s.select===r(this,Z))g=r(this,$);else try{f(this,Z,s.select),g=s.select(u.data),g=be(o==null?void 0:o.data,g,s),f(this,$,g),f(this,k,null)}catch(p){f(this,k,p)}else g=u.data;if(s.placeholderData!==void 0&&g===void 0&&C==="pending"){let p;if(o!=null&&o.isPlaceholderData&&s.placeholderData===(v==null?void 0:v.placeholderData))p=o.data;else if(p=typeof s.placeholderData=="function"?s.placeholderData((L=r(this,G))==null?void 0:L.state.data,r(this,G)):s.placeholderData,s.select&&p!==void 0)try{p=s.select(p),f(this,k,null)}catch(I){f(this,k,I)}p!==void 0&&(C="success",g=be(o==null?void 0:o.data,p,s),w=!0)}r(this,k)&&(P=r(this,k),g=r(this,$),E=Date.now(),C="error");const A=u.fetchStatus==="fetching",Q=C==="pending",F=C==="error",B=Q&&A,W=g!==void 0,x={status:C,fetchStatus:u.fetchStatus,isPending:Q,isSuccess:C==="success",isError:F,isInitialLoading:B,isLoading:B,data:g,dataUpdatedAt:u.dataUpdatedAt,error:P,errorUpdatedAt:E,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>b.dataUpdateCount||u.errorUpdateCount>b.errorUpdateCount,isFetching:A,isRefetching:A&&!Q,isLoadingError:F&&!W,isPaused:u.fetchStatus==="paused",isPlaceholderData:w,isRefetchError:F&&W,isStale:de(e,s),refetch:this.refetch,promise:r(this,_)};if(this.options.experimental_prefetchInRender){const p=D=>{x.status==="error"?D.reject(x.error):x.data!==void 0&&D.resolve(x.data)},I=()=>{const D=f(this,_,x.promise=pe());p(D)},T=r(this,_);switch(T.status){case"pending":e.queryHash===i.queryHash&&p(T);break;case"fulfilled":(x.status==="error"||x.data!==T.value)&&I();break;case"rejected":(x.status!=="error"||x.error!==T.reason)&&I();break}}return x}updateResult(e){const s=r(this,S),i=this.createResult(r(this,c),this.options);if(f(this,H,r(this,c).state),f(this,V,this.options),r(this,H).data!==void 0&&f(this,G,r(this,c)),se(i,s))return;f(this,S,i);const l={},o=()=>{if(!s)return!0;const{notifyOnChangeProps:n}=this.options,v=typeof n=="function"?n():n;if(v==="all"||!v&&!r(this,J).size)return!0;const d=new Set(v??r(this,J));return this.options.throwOnError&&d.add("error"),Object.keys(r(this,S)).some(b=>{const j=b;return r(this,S)[j]!==s[j]&&d.has(j)})};(e==null?void 0:e.listeners)!==!1&&o()&&(l.listeners=!0),m(this,h,Ee).call(this,{...l,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&m(this,h,oe).call(this)}},O=new WeakMap,c=new WeakMap,Y=new WeakMap,S=new WeakMap,H=new WeakMap,V=new WeakMap,_=new WeakMap,k=new WeakMap,Z=new WeakMap,$=new WeakMap,G=new WeakMap,K=new WeakMap,q=new WeakMap,M=new WeakMap,J=new WeakMap,h=new WeakSet,X=function(e){m(this,h,he).call(this);let s=r(this,c).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(Ie)),s},ie=function(){m(this,h,le).call(this);const e=z(this.options.staleTime,r(this,c));if(re||r(this,S).isStale||!me(e))return;const i=Te(r(this,S).dataUpdatedAt,e)+1;f(this,K,setTimeout(()=>{r(this,S).isStale||this.updateResult()},i))},ne=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,c)):this.options.refetchInterval)??!1},ae=function(e){m(this,h,ce).call(this),f(this,M,e),!(re||U(this.options.enabled,r(this,c))===!1||!me(r(this,M))||r(this,M)===0)&&f(this,q,setInterval(()=>{(this.options.refetchIntervalInBackground||Pe.isFocused())&&m(this,h,X).call(this)},r(this,M)))},oe=function(){m(this,h,ie).call(this),m(this,h,ae).call(this,m(this,h,ne).call(this))},le=function(){r(this,K)&&(clearTimeout(r(this,K)),f(this,K,void 0))},ce=function(){r(this,q)&&(clearInterval(r(this,q)),f(this,q,void 0))},he=function(){const e=r(this,O).getQueryCache().build(r(this,O),this.options);if(e===r(this,c))return;const s=r(this,c);f(this,c,e),f(this,Y,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},Ee=function(e){Ce.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(r(this,S))}),r(this,O).getQueryCache().notify({query:r(this,c),type:"observerResultsUpdated"})})},Re);function _e(t,e){return U(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function ye(t,e){return _e(t,e)||t.state.data!==void 0&&ue(t,e,e.refetchOnMount)}function ue(t,e,s){if(U(e.enabled,t)!==!1){const i=typeof s=="function"?s(t):s;return i==="always"||i!==!1&&de(t,e)}return!1}function ge(t,e,s,i){return(t!==e||U(i.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&de(t,s)}function de(t,e){return U(e.enabled,t)!==!1&&t.isStaleByTime(z(e.staleTime,t))}function Me(t,e){return!se(t.getCurrentResult(),e)}var Se=y.createContext(!1),Ae=()=>y.useContext(Se);Se.Provider;function Ne(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var He=y.createContext(Ne()),Ke=()=>y.useContext(He),qe=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},We=t=>{y.useEffect(()=>{t.clearReset()},[t])},Ve=({result:t,errorResetBoundary:e,throwOnError:s,query:i})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&Ue(s,[t.error,i]),$e=t=>{t.suspense&&(typeof t.staleTime!="number"&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},Ge=(t,e)=>t.isLoading&&t.isFetching&&!e,Je=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,ve=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Xe(t,e,s){var j,u,w,g,P;const i=Fe(),l=Ae(),o=Ke(),n=i.defaultQueryOptions(t);(u=(j=i.getDefaultOptions().queries)==null?void 0:j._experimental_beforeQuery)==null||u.call(j,n),n._optimisticResults=l?"isRestoring":"optimistic",$e(n),qe(n,o),We(o);const v=!i.getQueryCache().get(n.queryHash),[d]=y.useState(()=>new e(i,n)),b=d.getOptimisticResult(n);if(y.useSyncExternalStore(y.useCallback(E=>{const C=l?()=>{}:d.subscribe(Ce.batchCalls(E));return d.updateResult(),C},[d,l]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),y.useEffect(()=>{d.setOptions(n,{listeners:!1})},[n,d]),Je(n,b))throw ve(n,d,o);if(Ve({result:b,errorResetBoundary:o,throwOnError:n.throwOnError,query:i.getQueryCache().get(n.queryHash)}))throw b.error;if((g=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||g.call(w,n,b),n.experimental_prefetchInRender&&!re&&Ge(b,l)){const E=v?ve(n,d,o):(P=i.getQueryCache().get(n.queryHash))==null?void 0:P.promise;E==null||E.catch(Be).finally(()=>{d.hasListeners()||d.updateResult()})}return n.notifyOnChangeProps?b:d.trackResult(b)}function Oe(t,e){return Xe(t,Le)}const Ye=y.createContext(null),te={didCatch:!1,error:null};class Ze extends y.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=te}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var s,i,l=arguments.length,o=new Array(l),n=0;n<l;n++)o[n]=arguments[n];(s=(i=this.props).onReset)===null||s===void 0||s.call(i,{args:o,reason:"imperative-api"}),this.setState(te)}}componentDidCatch(e,s){var i,l;(i=(l=this.props).onError)===null||i===void 0||i.call(l,e,s)}componentDidUpdate(e,s){const{didCatch:i}=this.state,{resetKeys:l}=this.props;if(i&&s.error!==null&&ze(e.resetKeys,l)){var o,n;(o=(n=this.props).onReset)===null||o===void 0||o.call(n,{next:l,prev:e.resetKeys,reason:"keys"}),this.setState(te)}}render(){const{children:e,fallbackRender:s,FallbackComponent:i,fallback:l}=this.props,{didCatch:o,error:n}=this.state;let v=e;if(o){const d={error:n,resetErrorBoundary:this.resetErrorBoundary};if(typeof s=="function")v=s(d);else if(i)v=y.createElement(i,d);else if(l!==void 0)v=l;else throw n}return y.createElement(Ye.Provider,{value:{didCatch:o,error:n,resetErrorBoundary:this.resetErrorBoundary}},v)}}function ze(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==e.length||t.some((s,i)=>!Object.is(s,e[i]))}async function et(t){return await(await fetch(`https://pizza-backend-xpbk.onrender.com/api/past-orders?lpage=${t}`)).json()}async function tt(t){try{if(!t)return null;await new Promise(i=>setTimeout(i,5e3));const e=await fetch(`https://pizza-backend-xpbk.onrender.com/api/past-order/${t}`);return e.ok?await e.json():(console.warn(`âš ï¸ API response with status ${e.status}`),null)}catch(e){return console.error("ðŸš¨ Failed to fetch past order:",e),null}}const st=({children:t})=>{const e=y.useRef(null);return e.current||(e.current=document.createElement("div")),y.useEffect(()=>{const s=document.getElementById("modal");return s.appendChild(e.current),()=>s.removeChild(e.current)},[]),De.createPortal(a.jsx("div",{children:t}),e.current)},rt=new Intl.NumberFormat("en-us",{style:"currency",currency:"USD"}),xe=t=>rt.format(t),ht=ke("/past")({component:it});function it(){const t=je.c(6),[e,s]=y.useState(1);let i;t[0]!==e?(i={queryKey:["past-orders",e],queryFn:()=>et(e),staleTime:3e4},t[0]=e,t[1]=i):i=t[1];const l=Oe(i).promise;let o;t[2]===Symbol.for("react.memo_cache_sentinel")?(o=a.jsx("div",{className:"past-orders",children:a.jsx("h2",{children:"Loading Past Order..."})}),t[2]=o):o=t[2];let n;return t[3]!==l||t[4]!==e?(n=a.jsx(Ze,{children:a.jsx(y.Suspense,{fallback:o,children:a.jsx(nt,{loadedPromise:l,page:e,setPage:s})})}),t[3]=l,t[4]=e,t[5]=n):n=t[5],n}function nt(t){const e=je.c(39),{page:s,setPage:i,loadedPromise:l}=t,o=y.use(l),[n,v]=y.useState();let d,b;e[0]!==n?(d=["past-order",n],b=()=>tt(n),e[0]=n,e[1]=d,e[2]=b):(d=e[1],b=e[2]);const j=!!n;let u;e[3]!==d||e[4]!==b||e[5]!==j?(u={queryKey:d,queryFn:b,staleTime:864e5,enabled:j},e[3]=d,e[4]=b,e[5]=j,e[6]=u):u=e[6];const{isLoading:w,data:g}=Oe(u);let P;e[7]===Symbol.for("react.memo_cache_sentinel")?(P=a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("td",{children:"ID"}),a.jsx("td",{children:"Date"}),a.jsx("td",{children:"Time"})]})}),e[7]=P):P=e[7];let E;if(e[8]!==o){let T;e[10]===Symbol.for("react.memo_cache_sentinel")?(T=D=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("button",{onClick:()=>v(D.order_id),children:D.order_id})}),a.jsx("td",{children:D.date}),a.jsx("td",{children:D.time})]},D.order_id),e[10]=T):T=e[10],E=o.map(T),e[8]=o,e[9]=E}else E=e[9];let C;e[11]!==E?(C=a.jsxs("table",{children:[P,a.jsx("tbody",{children:E})]}),e[11]=E,e[12]=C):C=e[12];const A=s<=1;let Q;e[13]!==s||e[14]!==i?(Q=()=>i(s-1),e[13]=s,e[14]=i,e[15]=Q):Q=e[15];let F;e[16]!==A||e[17]!==Q?(F=a.jsx("button",{disabled:A,onClick:Q,children:"Previous"}),e[16]=A,e[17]=Q,e[18]=F):F=e[18];let B;e[19]!==s?(B=a.jsx("div",{children:s}),e[19]=s,e[20]=B):B=e[20];const W=o.length<10;let N;e[21]!==s||e[22]!==i?(N=()=>i(s+1),e[21]=s,e[22]=i,e[23]=N):N=e[23];let x;e[24]!==W||e[25]!==N?(x=a.jsx("button",{disabled:W,onClick:N,children:"Next"}),e[24]=W,e[25]=N,e[26]=x):x=e[26];let L;e[27]!==F||e[28]!==B||e[29]!==x?(L=a.jsxs("div",{className:"pages",children:[F,B,x]}),e[27]=F,e[28]=B,e[29]=x,e[30]=L):L=e[30];let p;e[31]!==n||e[32]!==w||e[33]!==g?(p=n?a.jsxs(st,{children:[a.jsxs("h2",{children:["Order #",n]}),w?a.jsx("p",{children:"Loading ..."}):a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("td",{children:"Image"}),a.jsx("td",{children:"Name"}),a.jsx("td",{children:"Size"}),a.jsx("td",{children:"Quantity"}),a.jsx("td",{children:"Price"}),a.jsx("td",{children:"Total"})]})}),a.jsx("tbody",{children:g.orderItems.map(at)})]}),a.jsx("button",{onClick:()=>v(),children:"Close"})]}):null,e[31]=n,e[32]=w,e[33]=g,e[34]=p):p=e[34];let I;return e[35]!==L||e[36]!==p||e[37]!==C?(I=a.jsxs("div",{className:"past-orders",children:[C,L,p]}),e[35]=L,e[36]=p,e[37]=C,e[38]=I):I=e[38],I}function at(t){return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("img",{src:t.image,alt:t.name})}),a.jsx("td",{children:t.name}),a.jsx("td",{children:t.size}),a.jsx("td",{children:t.quantity}),a.jsx("td",{children:xe(t.price)}),a.jsx("td",{children:xe(t.total)})]},`${t.pizzaTypeId}_${t.size}`)}export{ht as Route};
